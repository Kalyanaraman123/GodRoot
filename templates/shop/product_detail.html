{% extends 'base.html' %}
{% load static %}
{% block title %}{{ product.title }} — TIMEO{% endblock %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/site.css' %}">
{% endblock %}

{% block content %}
<div class="site">
  <a href="{% url 'shop:home' %}">&larr; Back to shop</a>

  <div class="container product-detail" style="display:grid;grid-template-columns:1fr 420px;gap:20px;margin-top:18px">
    <div>
      {% if product.images.all %}
        <div style="display:grid;grid-template-columns:1fr 100px;gap:10px">
          <div style="background:#fff;border:1px solid #eee;padding:8px">
            <img src="{{ product.images.all.0.image.url }}" style="width:100%;height:auto;object-fit:cover">
          </div>
          <div style="display:flex;flex-direction:column;gap:8px">
            {% for img in product.images.all %}
              <img src="{{ img.image.url }}" style="width:100%;height:80px;object-fit:cover;border:1px solid #eee">
            {% endfor %}
          </div>
        </div>
      {% else %}
        <div style="height:340px;background:#f4f4f4;display:flex;align-items:center;justify-content:center">No image</div>
      {% endif %}
    </div>

    <aside style="background:#fff;padding:18px;border-radius:10px;border:1px solid #eee">
      <h1 style="margin:0 0 8px 0">{{ product.title }}</h1>
      {% with first_variant=product.variants.all|first %}
        {% if first_variant %}
          <div class="price">₹{{ first_variant.price }}</div>
        {% else %}
          <div class="price">Price not set</div>
        {% endif %}
      {% endwith %}

      <p class="muted" style="margin-top:12px">{{ product.description|linebreaksbr }}</p>

      {% if product.variants.exists %}
        <form method="post" action="{% url 'shop:cart_add' product.variants.all.0.id %}">
          {% csrf_token %}
          <label class="muted">Quantity</label>
          <input type="number" name="quantity" value="1" min="1" style="width:72px;margin-bottom:12px">
          <button class="btn" type="submit">Add to cart</button>
        </form>
      {% else %}
        <p><em>Sold out / no variants</em></p>
      {% endif %}
    </aside>
  </div>

  <footer class="footer" style="margin-top:28px">© TIMEO — demo</footer>
</div>
{% endblock %}
